services:
  lesmots_backend:
    healthcheck:
      test: [ "CMD-SHELL", "netstat -an | grep :9000 || exit 1" ]
      interval: 6s
      timeout: 6s
      retries: 40
    environment:
      # DATABASE
      DB_DATABASE: ${DATABASE_NAME}
      DB_USERNAME: ${DATABASE_USER}
      DB_PASSWORD: ${DATABASE_PASSWORD}
      DB_HOST: lesmots_database

  lesmots_backend_webserver:
    depends_on:
      lesmots_backend:
        condition: service_healthy

  lesmots_backend_cron:
    extends: lesmots_backend
    depends_on:
      lesmots_backend:
        condition: service_healthy
